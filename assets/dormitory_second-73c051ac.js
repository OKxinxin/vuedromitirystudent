import{_ as D,d as w,o as u,c as h,a as s,b as l,w as t,E as k,i as N,e as v,f as B,F as I,r as _,m as C,g as n,V as F,h as U,j as E,k as L}from"./index-f8789b21.js";import{a as W,E as A}from"./el-select-778a89da.js";import{a as $,b as R,e as T,c as z,d as S}from"./DormitoryManagement-1064e5d8.js";import"./validator-0b020f7f.js";const M=w({data(){return{selectedBuildingName:"",buildings:[],allDormitories:[],selectedBuildingDormitories:[],searchId:"",dialogFormVisible:!1,dialogFormVisibleById:!1,editingDormitory:null,editDormitory(e){this.editingDormitory={...e},this.dormitory={...e},this.dialogFormVisible=!0},student:{dormitoryId:0,studentId:0,studentName:"",classinfo:""},dormitory:{building:"",comment:"",id:0,leader:0,leftNumber:0,liveNumber:0,maxNumber:0,name:"",school:"",status:0,type:0},formLabelWidth:"100px",searchText:"",schoolId:0}},mounted(){this.getAllBuildingData(),this.getAllDormitoryData();const e=new URLSearchParams(window.location.search);this.schoolId=e.get("schoolId"),console.log("选择的学校Id1:",this.schoolId)},watch:{selectedBuildingName(e){this.selectedBuildingDormitories=this.allDormitories.filter(o=>o.building===e)}},methods:{editMembers(e){this.$router.push({path:"/dormitory_third",query:{id:e}})},getAllBuildingData(){$().then(e=>{if(console.log("建筑",e),e){console.log("选择的学校Id2:",this.schoolId);const o=e.data.buildings;console.log("建筑23",o),this.buildings=o.filter(b=>b.schoolId===parseInt(this.schoolId)),console.log("建筑2",this.buildings)}else console.log(e)}).catch(e=>{console.log(e)})},getAllDormitoryData(){R().then(e=>{console.log(e),e?(this.allDormitories=e.data.dormitories,this.selectedBuildingDormitories=this.allDormitories):console.log(e)}).catch(e=>{console.log(e)})},addDormitory(){this.dialogFormVisible=!0},save(){this.editingDormitory?T(this.dormitory).then(e=>{console.log(e),e&&e.code===1?(this.getAllDormitoryData(),this.editingDormitory=null,this.dormitory={building:"",comment:"",id:0,leader:0,leftNumber:0,liveNumber:0,maxNumber:0,name:"",school:"",status:0,type:0},this.dialogFormVisible=!1):console.log(e)}).catch(e=>{console.log(e)}):z(this.dormitory).then(e=>{console.log(e),e&&e.code===1?(this.getAllDormitoryData(),this.dormitory={building:"",comment:"",id:0,leader:0,leftNumber:0,liveNumber:0,maxNumber:0,name:"",school:"",status:0,type:0},this.dialogFormVisible=!1):console.log(e)}).catch(e=>{console.log(e)})},editDormitory(e){this.editingDormitory={...e},this.dormitory={...e},this.dialogFormVisible=!0},deleteDormitory(e){S({id:e}).then(o=>{console.log(o),o&&o.code===1?(this.getAllDormitoryData(),this.dialogFormVisible=!1,this.editingDormitory=null):console.log(o)}).catch(o=>{console.log(o)})},searchDormitory(){const e=this.searchId.trim();e===""?this.selectedBuildingDormitories=this.allDormitories:this.selectedBuildingDormitories=this.allDormitories.filter(o=>o.name.includes(e))},getdormitoryById(e){console.log(e)}}}),j={class:"container1"},q={class:"sidebar"},O=s("h2",{class:"sidebar-title"},"请选择管理宿舍楼",-1),P={class:"content"},G=s("h1",{class:"title"},"微校园管理-宿舍管理",-1),H={class:"center"},J={key:0},K=s("h2",null,"宿舍信息",-1),Q={key:1},X=s("p",null,"暂无宿舍信息",-1),Y=[X],Z={class:"dialog-footer"};function x(e,o,b,ee,le,oe){const p=A,g=W,m=k,a=N,d=U,y=v,r=E,c=L,V=B;return u(),h("div",j,[s("div",q,[O,l(g,{modelValue:e.selectedBuildingName,"onUpdate:modelValue":o[0]||(o[0]=i=>e.selectedBuildingName=i),placeholder:"请选择建筑",class:"select-box"},{default:t(()=>[(u(!0),h(I,null,_(e.buildings,i=>(u(),C(p,{key:i.id,label:i.name,value:i.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",P,[G,s("div",H,[e.selectedBuildingName&&e.selectedBuildingDormitories.length>0?(u(),h("div",J,[K,l(m,{type:"warning",onClick:e.addDormitory},{default:t(()=>[n("添加宿舍")]),_:1},8,["onClick"]),l(a,{modelValue:e.searchId,"onUpdate:modelValue":o[1]||(o[1]=i=>e.searchId=i),placeholder:"请输入宿舍名称",clearable:"",style:{width:"120px"}},null,8,["modelValue"]),l(m,{type:"primary",onClick:e.searchDormitory},{default:t(()=>[n("搜索")]),_:1},8,["onClick"]),l(y,{data:e.selectedBuildingDormitories,style:{width:"100%"},onRowClick:e.handleRowClick},{default:t(()=>[l(d,{fixed:"",prop:"id",label:"ID",width:"80"}),l(d,{fixed:"",prop:"name",label:"名称",width:"120"}),l(d,{fixed:"",prop:"leader",label:"宿舍长",width:"120"}),l(d,{fixed:"",prop:"maxNumber",label:"最大人数",width:"120"}),l(d,{fixed:"",prop:"leftNumber",label:"剩余人数",width:"120"}),l(d,{fixed:"",prop:"liveNumber",label:"居住人数",width:"120"}),l(d,{fixed:"",prop:"status",label:"状态",width:"120"}),l(d,{fixed:"",prop:"comment",label:"备注",width:"120"}),l(d,{fixed:"",prop:"school",label:"学校",width:"120"}),l(d,{fixed:"",prop:"type",label:"类型",width:"120"}),l(d,{fixed:"",prop:"building",label:"建筑",width:"120"}),l(d,{fixed:"right",label:"操作",width:"120"},{default:t(i=>[l(m,{link:"",type:"primary",size:"small",onClick:f=>e.editDormitory(i.row)},{default:t(()=>[n("编辑")]),_:2},1032,["onClick"]),l(m,{link:"",type:"primary",size:"small",onClick:f=>e.deleteDormitory(i.row.id)},{default:t(()=>[n("删除")]),_:2},1032,["onClick"]),l(m,{link:"",type:"primary",size:"small",onClick:f=>e.editMembers(i.row.id)},{default:t(()=>[n("修改宿舍成员")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onRowClick"])])):(u(),h("div",Q,Y))])]),l(V,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":o[12]||(o[12]=i=>e.dialogFormVisible=i),title:"添加宿舍"},{footer:t(()=>[s("span",Z,[l(m,{onClick:o[11]||(o[11]=i=>e.dialogFormVisible=!1)},{default:t(()=>[n("取消")]),_:1}),l(m,{type:"primary",onClick:e.save},{default:t(()=>[n(F(e.editingDormitory?"保存":"添加"),1)]),_:1},8,["onClick"])])]),default:t(()=>[l(c,{model:e.dormitory},{default:t(()=>[l(r,{label:"名称","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.name,"onUpdate:modelValue":o[2]||(o[2]=i=>e.dormitory.name=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"宿舍长","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.leader,"onUpdate:modelValue":o[3]||(o[3]=i=>e.dormitory.leader=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"最大人数","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.maxNumber,"onUpdate:modelValue":o[4]||(o[4]=i=>e.dormitory.maxNumber=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"剩余人数","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.leftNumber,"onUpdate:modelValue":o[5]||(o[5]=i=>e.dormitory.leftNumber=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"入住人数","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.liveNumber,"onUpdate:modelValue":o[6]||(o[6]=i=>e.dormitory.liveNumber=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"状态","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.status,"onUpdate:modelValue":o[7]||(o[7]=i=>e.dormitory.status=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"学校","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.school,"onUpdate:modelValue":o[8]||(o[8]=i=>e.dormitory.school=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"类型","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.type,"onUpdate:modelValue":o[9]||(o[9]=i=>e.dormitory.type=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"建筑","label-width":e.formLabelWidth},{default:t(()=>[l(a,{modelValue:e.dormitory.building,"onUpdate:modelValue":o[10]||(o[10]=i=>e.dormitory.building=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const re=D(M,[["render",x]]);export{re as default};
